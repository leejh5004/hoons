<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TWOHOONS GARAGE</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1e40af">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="TWOHOONS GARAGE">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="logo.png" as="image" type="image/png">
    
    <!-- Fonts (Optimized) - 한글+영문 통합, 불필요한 weight 제거 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Bootstrap 제거: 실제 사용량 적어서 직접 구현이 더 효율적 -->
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase (Optimized Loading) -->
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script defer src="firebase-config.js"></script>
    
    <!-- PDF Generation (Lazy Load) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script defer src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <!-- QR Code Generation (Lazy Load) -->
    <script defer src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>

<body>
    <!-- Top Header (Fixed) -->
    <header class="top-header">
        <div class="header-content">
            <div class="header-left">
                <img src="logo.png" alt="TWOHOONS" class="header-logo" decoding="async">
                <span class="header-title">TWOHOONS</span>
            </div>
            <div class="header-right">
                <button class="header-btn" id="themeToggle" title="다크모드 전환">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="header-btn notification-btn" id="notificationBtn" title="알림">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge">0</span>
                </button>
                <button class="header-btn profile-btn" id="profileBtn" title="프로필">
                    <i class="fas fa-user-circle"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Login Screen -->
        <div id="loginScreen" class="screen active">
            <div class="auth-container">
                <div class="auth-header">
                    <img src="logo.png" alt="TWOHOONS GARAGE" class="auth-logo" decoding="async">
                    <h1 class="auth-title">TWOHOONS GARAGE</h1>
                    <p class="auth-subtitle">이륜차 정비 관리 시스템</p>
                </div>
                
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">로그인</button>
                    <button class="auth-tab" data-tab="register">회원가입</button>
                </div>
                
                <!-- Login Form -->
                <form id="loginForm" class="auth-form active">
                    <div class="input-group">
                        <i class="fas fa-envelope input-icon"></i>
                        <input type="email" id="loginEmail" placeholder="이메일" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="loginPassword" placeholder="비밀번호" required>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        로그인
                    </button>
                    <div class="auth-footer">
                        <button type="button" class="forgot-password-link" onclick="showPasswordResetModal()" title="비밀번호 재설정">
                            <i class="fas fa-key"></i>
                            비밀번호를 잊으셨나요?
                        </button>
                    </div>
                </form>
                
                <!-- Register Form -->
                <form id="registerForm" class="auth-form">
                    <div class="input-group">
                        <i class="fas fa-user input-icon"></i>
                        <input type="text" id="registerName" placeholder="이름" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-envelope input-icon"></i>
                        <input type="email" id="registerEmail" placeholder="이메일" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="registerPassword" placeholder="비밀번호 (6자 이상)" required>
                    </div>
                    <div class="input-group motorcycle-number-group">
                        <i class="fas fa-motorcycle input-icon"></i>
                        <input type="text" id="registerCarNumber" placeholder="오토바이 번호를 정확히 입력해주세요" required>
                        <button type="button" class="help-btn" id="motorcycleHelpBtn" title="오토바이 번호 입력 도움말">
                            <i class="fas fa-question-circle"></i>
                        </button>
                        <div class="motorcycle-number-examples">
                            <small class="example-text">
                                <i class="fas fa-info-circle"></i>
                                <strong>예시:</strong> 제주서귀포차3107, 부산해운대바1234, 경기수원가5678
                            </small>
                        </div>
                        <div class="input-validation hidden" id="motorcycleValidation">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span id="validationMessage"></span>
                        </div>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-user-plus"></i>
                        회원가입
                    </button>
                </form>
            </div>
        </div>

        <!-- Main Dashboard Screen -->
        <div id="dashboardScreen" class="screen">
            <!-- Dashboard Stats -->
            <div class="dashboard-stats">
                <div class="stat-card" data-stat="today">
                    <div class="stat-icon today">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-number" id="todayCount">0</h3>
                        <p class="stat-label">오늘 정비</p>
                    </div>
                </div>
                
                <div class="stat-card" data-stat="pending">
                    <div class="stat-icon pending">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-number" id="pendingCount">0</h3>
                                                        <p class="stat-label">확인 대기</p>
                    </div>
                </div>
                
                <div class="stat-card" data-stat="month">
                    <div class="stat-icon month">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-number" id="monthCount">0</h3>
                        <p class="stat-label">이번 달</p>
                    </div>
                </div>
                
                <div class="stat-card" data-stat="average">
                    <div class="stat-icon average">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <div class="stat-content">
                        <h3 class="stat-number" id="averageDays">0</h3>
                        <p class="stat-label">평균 간격</p>
                    </div>
                </div>
            </div>

            <!-- Quick Search & Filters -->
            <div class="search-section">
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="quickSearch" placeholder="정비 이력 검색...">
                    <button class="filter-toggle" id="filterToggle" title="필터 토글">
                        <i class="fas fa-filter"></i>
                    </button>
                </div>
                
                <div class="filter-chips" id="filterChips">
                    <div class="filter-chip active" data-filter="all">
                        <i class="fas fa-list"></i>
                        전체
                    </div>
                    <div class="filter-chip" data-filter="in-progress">
                        <i class="fas fa-cog fa-spin"></i>
                        진행중
                    </div>
                    <div class="filter-chip" data-filter="completed">
                        <i class="fas fa-check"></i>
                        완료됨
                    </div>
                    <div class="filter-chip" data-filter="approved">
                        <i class="fas fa-check-double"></i>
                                                                확인
                    </div>
                    <div class="filter-chip" data-filter="rejected">
                        <i class="fas fa-times"></i>
                        거절
                    </div>
                </div>
            </div>

            <!-- Maintenance Timeline -->
            <div class="timeline-section">
                <div class="timeline-header">
                    <h2 class="timeline-title">
                        <i class="fas fa-history"></i>
                        정비 이력
                    </h2>
                    <div class="timeline-actions">
                        <button class="view-toggle" id="viewToggle" title="보기 전환">
                            <i class="fas fa-th-large"></i>
                        </button>
                    </div>
                </div>
                
                <div class="timeline-container" id="timelineContainer">
                    <div class="loading-spinner" id="loadingSpinner">
                        <div class="spinner"></div>
                        <p>정비 이력을 불러오는 중...</p>
                    </div>
                    
                    <div class="timeline-content" id="timelineContent">
                        <!-- Maintenance cards will be dynamically inserted here -->
                    </div>
                    
                    <div class="empty-state hidden" id="emptyState">
                        <i class="fas fa-inbox"></i>
                        <h3>정비 이력이 없습니다</h3>
                        <p>첫 번째 정비를 등록해보세요!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Taxation Screen -->
        <div id="taxationScreen" class="screen">
            <!-- Taxation Header -->
            <div class="taxation-header">
                <div class="taxation-title">
                    <h1>
                        <i class="fas fa-calculator"></i>
                        세무 관리
                        <button class="help-toggle-btn" onclick="showTaxHelpCenter()" title="세무 도움말">
                            <i class="fas fa-question-circle"></i>
                        </button>
                    </h1>
                    <p class="taxation-subtitle">간편한 세무 관리 솔루션</p>
                </div>
                <div class="taxation-period">
                    <select id="taxationYear" class="period-select" title="세무 연도 선택">
                        <option value="2024">2024년</option>
                        <option value="2023">2023년</option>
                    </select>
                    <select id="taxationQuarter" class="period-select" title="세무 분기 선택">
                        <option value="1">1분기</option>
                        <option value="2">2분기</option>
                        <option value="3">3분기</option>
                        <option value="4">4분기</option>
                    </select>
                </div>
            </div>

            <!-- Taxation Summary Cards -->
            <div class="taxation-summary">
                <div class="tax-card income-card">
                    <div class="tax-card-header">
                        <i class="fas fa-arrow-up"></i>
                        <h3>매출</h3>
                    </div>
                    <div class="tax-card-body">
                        <div class="tax-amount" id="totalIncome">0원</div>
                        <div class="tax-detail">
                            <span>공급가액: <span id="incomeSupply">0원</span></span>
                            <span>부가세: <span id="incomeVat">0원</span></span>
                        </div>
                    </div>
                </div>

                <div class="tax-card expense-card">
                    <div class="tax-card-header">
                        <i class="fas fa-arrow-down"></i>
                        <h3>매입</h3>
                    </div>
                    <div class="tax-card-body">
                        <div class="tax-amount" id="totalExpense">0원</div>
                        <div class="tax-detail">
                            <span>공급가액: <span id="expenseSupply">0원</span></span>
                            <span>부가세: <span id="expenseVat">0원</span></span>
                        </div>
                    </div>
                </div>

                <div class="tax-card vat-card">
                    <div class="tax-card-header">
                        <i class="fas fa-percent"></i>
                        <h3>부가세</h3>
                    </div>
                    <div class="tax-card-body">
                        <div class="tax-amount" id="vatToPay">0원</div>
                        <div class="tax-detail">
                            <span>납부예정액</span>
                            <span class="vat-status" id="vatStatus">미신고</span>
                        </div>
                    </div>
                </div>

                <div class="tax-card calendar-card">
                    <div class="tax-card-header">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>신고일정</h3>
                    </div>
                    <div class="tax-card-body">
                        <div class="tax-amount" id="nextDeadline">D-15</div>
                        <div class="tax-detail">
                            <span>부가세 신고</span>
                            <span>2024.04.25</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Taxation Quick Actions -->
            <div class="taxation-actions">
                                    <button class="tax-action-btn primary" onclick="showIncomeModal()" title="수입 등록">
                    <i class="fas fa-plus"></i>
                    <span>매출 등록</span>
                </button>
                                    <button class="tax-action-btn secondary" onclick="showExpenseModal()" title="지출 등록">
                    <i class="fas fa-minus"></i>
                    <span>경비 등록</span>
                </button>
                                    <button class="tax-action-btn accent" onclick="showSalaryModal()" title="급여 관리">
                    <i class="fas fa-users"></i>
                    <span>급여 관리</span>
                </button>
                                    <button class="tax-action-btn info" onclick="showTaxReport()" title="세무 리포트">
                    <i class="fas fa-file-alt"></i>
                    <span>부가세 신고</span>
                </button>
                                    <button class="tax-action-btn warning" onclick="showTaxReportOptions()" title="세무 리포트 옵션">
                    <i class="fas fa-download"></i>
                    <span>세무 리포트</span>
                </button>
                <button class="tax-action-btn danger" onclick="showPDFLibraryHelp()" title="PDF 생성 문제가 있을 때 사용하세요">
                    <i class="fas fa-wrench"></i>
                    <span>PDF 문제 해결</span>
                </button>
            </div>

            <!-- Taxation Categories -->
            <div class="taxation-categories">
                <div class="category-header">
                    <h3>
                        <i class="fas fa-chart-pie"></i>
                        분류별 현황
                    </h3>
                    <button class="category-toggle" onclick="toggleCategoryView()" title="분류별 현황 토글">
                        <i class="fas fa-expand-alt"></i>
                    </button>
                </div>
                
                <div class="category-grid" id="categoryGrid">
                    <!-- 동적으로 생성될 카테고리 카드들 -->
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="taxation-recent">
                <div class="recent-header">
                    <h3>
                        <i class="fas fa-clock"></i>
                        최근 거래
                    </h3>
                    <button class="view-all-btn" onclick="handleViewAllClick()" title="전체 거래 보기">
                        전체보기
                    </button>
                </div>
                
                <div class="recent-list" id="recentTransactions">
                    <!-- 동적으로 생성될 최근 거래 목록 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" id="addMaintenanceFab" title="새 정비 등록">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Scroll to Top Button -->
                    <button class="scroll-to-top hidden" id="scrollToTopBtn" title="맨 위로">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-screen="dashboard">
            <i class="fas fa-home"></i>
            <span>홈</span>
        </button>
        <button class="nav-item" data-screen="add">
            <i class="fas fa-plus-circle"></i>
            <span>등록</span>
        </button>
            <button class="nav-item" id="taxationNavItem" data-screen="taxation">
        <i class="fas fa-calculator"></i>
        <span>세무</span>
    </button>
        <button class="nav-item" data-screen="search">
            <i class="fas fa-search"></i>
            <span>검색</span>
        </button>
        <button class="nav-item" data-screen="profile">
            <i class="fas fa-user"></i>
            <span>프로필</span>
        </button>
    </nav>

    <!-- Maintenance Input Modal -->
    <div id="maintenanceModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-tools"></i>
                    새 정비 등록
                </h2>
                <button class="modal-close" onclick="closeMaintenanceModal()" title="모달 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="maintenanceForm" class="maintenance-form" onsubmit="submitMaintenanceForm(event)">
                    <!-- Step 1: Basic Info -->
                    <div class="form-step active" data-step="1">
                        <div class="step-header">
                            <h3>기본 정보</h3>
                            <span class="step-indicator">1/3</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="carNumber">오토바이 번호</label>
                            <div class="input-with-icon">
                                <i class="fas fa-motorcycle"></i>
                                <input type="text" id="carNumber" required placeholder="오토바이 번호 입력">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="maintenanceDate">정비 날짜</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-calendar"></i>
                                    <input type="date" id="maintenanceDate" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="mileage">키로수</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <input type="number" id="mileage" placeholder="주행거리">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="maintenanceType">정비 종류</label>
                            <div class="type-selector">
                                <div class="type-option" data-type="일반점검">
                                    <i class="fas fa-search"></i>
                                    <span>일반점검</span>
                                </div>
                                <div class="type-option" data-type="엔진오일교체">
                                    <i class="fas fa-oil-can"></i>
                                    <span>엔진오일교체</span>
                                </div>
                                <div class="type-option" data-type="타이어교체">
                                    <i class="fas fa-circle"></i>
                                    <span>타이어교체</span>
                                </div>
                                <div class="type-option" data-type="브레이크정비">
                                    <i class="fas fa-stop-circle"></i>
                                    <span>브레이크정비</span>
                                </div>
                                <div class="type-option" data-type="기타">
                                    <i class="fas fa-wrench"></i>
                                    <span>기타</span>
                                </div>
                            </div>
                            <input type="hidden" id="maintenanceType" required>
                        </div>
                    </div>
                    
                    <!-- Step 2: Photos -->
                    <div class="form-step" data-step="2">
                        <div class="step-header">
                            <h3>정비 사진</h3>
                            <span class="step-indicator">2/3</span>
                        </div>
                        
                        <div class="photo-upload-section">
                            <!-- 개선된 사진 업로드 영역 -->
                            <div class="enhanced-photo-upload">
                                <div class="upload-header">
                                    <h4><i class="fas fa-images"></i> 정비 사진</h4>
                                    <div class="upload-controls">
                                        <button type="button" class="btn-upload-all" id="uploadAllBtn">
                                            <i class="fas fa-camera"></i> 사진 촬영/선택
                                        </button>
                                        <input type="file" id="photoInput" accept="image/*" multiple class="file-input-hidden">
                                    </div>
                                </div>
                                
                                <!-- 드래그 앤 드롭 영역 -->
                                <div class="drag-drop-area" id="dragDropArea">
                                    <div class="drag-drop-content">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <h5>사진을 여기에 드래그하거나 클릭하세요</h5>
                                        <p>정비 사진을 자유롭게 업로드할 수 있습니다</p>
                                        <small>📸 카메라 촬영 또는 갤러리에서 선택 가능 • 최대 10장까지 업로드 가능</small>
                                    </div>
                                </div>
                                
                                <!-- 사진 미리보기 그리드 -->
                                <div class="photo-grid" id="photoGrid">
                                    <!-- 동적으로 생성될 사진 슬롯들 -->
                                </div>
                                
                                <!-- 업로드 상태 표시 -->
                                <div class="upload-status" id="uploadStatus">
                                    <div class="status-item">
                                        <span class="status-text">선택된 사진: </span>
                                        <span class="status-count" id="selectedCount">0</span>
                                        <span class="status-text">/ 10</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="photo-retention-notice">
                            <i class="fas fa-info-circle"></i>
                            <small>📸 업로드된 사진은 30일 후 자동 삭제됩니다.</small>
                            <br>
                            <small style="margin-top: 4px; display: block; font-size: 12px; opacity: 0.8;">
                                💡 삭제 5일 전부터 경고 알림이 표시되며, 상세보기에서 다운로드 가능합니다.
                            </small>
                        </div>
                    </div>
                    
                    <!-- Step 3: Description -->
                    <div class="form-step" data-step="3">
                        <div class="step-header">
                            <h3>상세 설명</h3>
                            <span class="step-indicator">3/3</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="description">정비 내용</label>
                            <textarea id="description" rows="6" placeholder="정비 내용을 자세히 설명해주세요..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="tags">태그 (선택사항)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-hashtag"></i>
                                <input type="text" id="tags" placeholder="예: #정기점검 #오일교체">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="prevStep" style="display: none;">
                    <i class="fas fa-arrow-left"></i>
                    이전
                </button>
                <button type="button" class="btn btn-primary" id="nextStep">
                    다음
                    <i class="fas fa-arrow-right"></i>
                </button>
                <button type="submit" class="btn btn-success" id="submitForm" style="display: none;" form="maintenanceForm">
                    <i class="fas fa-save"></i>
                    저장
                </button>
            </div>
        </div>
    </div>

    <!-- Maintenance Detail Modal -->
    <div id="detailModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-info-circle"></i>
                    정비 상세
                </h2>
                <button class="modal-close" onclick="closeDetailModal()" title="상세보기 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="detailModalBody">
                <!-- Detail content will be dynamically inserted -->
            </div>
        </div>
    </div>

    <!-- Estimate Search Modal -->
    <div id="estimateSearchModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-search"></i>
                    견적서 조회
                </h2>
                <button class="modal-close" onclick="closeEstimateSearchModal()" title="견적서 검색 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label for="estimateNumberInput">견적서 번호</label>
                    <div class="input-with-icon">
                        <i class="fas fa-receipt"></i>
                        <input type="text" id="estimateNumberInput" placeholder="000000" maxlength="6" pattern="[0-9]{6}">
                    </div>
                    <small style="color: var(--text-tertiary); margin-top: 8px; display: block;">
                        💡 견적서 PDF 하단에 표시된 6자리 번호를 입력해주세요
                    </small>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeEstimateSearchModal()">
                    <i class="fas fa-times"></i>
                    취소
                </button>
                <button type="button" class="btn btn-primary" onclick="handleEstimateSearchSubmit()">
                    <i class="fas fa-search"></i>
                    조회
                </button>
            </div>
        </div>
    </div>

    <!-- Estimate Detail Modal -->
    <div id="estimateDetailModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-receipt"></i>
                    견적서 상세
                </h2>
                <button class="modal-close" onclick="closeEstimateDetailModal()" title="견적서 상세 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="estimateDetailBody">
                <!-- Content will be dynamically inserted -->
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeEstimateDetailModal()">
                    <i class="fas fa-times"></i>
                    닫기
                </button>
                <button type="button" class="btn btn-primary" onclick="showEstimateSearchModal()">
                    <i class="fas fa-search"></i>
                    다시 조회
                </button>
            </div>
        </div>
    </div>

    <!-- Monthly Estimate Download Modal -->
    <div id="monthlyEstimateModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-download"></i>
                    월별 견적서 다운로드
                </h2>
                <button class="modal-close" onclick="closeMonthlyEstimateModal()" title="월별 견적서 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label for="downloadYear">📅 연도</label>
                    <select id="downloadYear" class="form-control" title="다운로드 연도 선택">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="downloadMonth">📅 월</label>
                    <select id="downloadMonth" class="form-control" title="다운로드 월 선택">
                        <option value="1">1월</option>
                        <option value="2">2월</option>
                        <option value="3">3월</option>
                        <option value="4">4월</option>
                        <option value="5">5월</option>
                        <option value="6">6월</option>
                        <option value="7">7월</option>
                        <option value="8">8월</option>
                        <option value="9">9월</option>
                        <option value="10">10월</option>
                        <option value="11">11월</option>
                        <option value="12">12월</option>
                    </select>
                </div>
                
                <div class="progress-container progress-container-hidden" id="downloadProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="downloadProgressBar"></div>
                    </div>
                    <p id="downloadStatusText" class="progress-text">견적서를 검색하고 있습니다...</p>
                </div>
                
                <div class="download-preview download-preview-hidden" id="downloadPreview">
                    <h4>📋 다운로드 예정 목록</h4>
                    <div id="downloadPreviewList"></div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeMonthlyEstimateModal()">
                    <i class="fas fa-times"></i>
                    취소
                </button>
                <button type="button" class="btn btn-primary" onclick="downloadMonthlyEstimates()">
                    <i class="fas fa-download"></i>
                    다운로드
                </button>
            </div>
        </div>
    </div>

    <!-- Password Reset Modal -->
    <div id="passwordResetModal" class="modal-overlay">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-key"></i>
                    비밀번호 재설정
                </h2>
                <button class="modal-close" onclick="closePasswordResetModal()" title="비밀번호 재설정 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="reset-info">
                    <p>가입하신 이메일 주소를 입력해주세요. 비밀번호 재설정 링크를 보내드립니다.</p>
                </div>
                
                <form id="passwordResetForm">
                    <div class="form-group">
                        <label for="resetEmail">이메일 주소</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="resetEmail" placeholder="등록된 이메일을 입력하세요" required>
                        </div>
                    </div>
                </form>
                
                <div class="reset-success reset-success-hidden" id="resetSuccess">
                    <div class="success-message">
                        <i class="fas fa-check-circle"></i>
                        <h4>이메일을 보냈습니다!</h4>
                        <p>입력하신 이메일로 비밀번호 재설정 링크를 보냈습니다. 이메일을 확인해주세요.</p>
                        <small style="color: var(--text-tertiary); margin-top: 8px; display: block;">
                            💡 이메일이 보이지 않으면 스팸함을 확인해보세요
                        </small>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePasswordResetModal()">
                    <i class="fas fa-times"></i>
                    취소
                </button>
                <button type="submit" class="btn btn-primary" form="passwordResetForm" id="sendResetBtn">
                    <i class="fas fa-paper-plane"></i>
                    재설정 링크 보내기
                </button>
            </div>
        </div>
    </div>

    <!-- Salary Management Modal -->
    <div id="salaryModal" class="modal-overlay">
        <div class="modal-container large-modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-users"></i>
                    직원 급여 관리
                </h2>
                <button class="modal-close" onclick="closeSalaryModal()" title="급여 관리 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- Salary Management Tabs -->
                <div class="salary-tabs">
                    <button class="salary-tab active" data-tab="employees" onclick="showSalaryTab('employees')">
                        <i class="fas fa-user-plus"></i>
                        직원 관리
                    </button>
                    <button class="salary-tab" data-tab="calculation" onclick="showSalaryTab('calculation')">
                        <i class="fas fa-calculator"></i>
                        급여 계산
                    </button>
                    <button class="salary-tab" data-tab="history" onclick="showSalaryTab('history')">
                        <i class="fas fa-history"></i>
                        지급 이력
                    </button>
                    <button class="salary-tab" data-tab="insurance" onclick="showSalaryTab('insurance')">
                        <i class="fas fa-shield-alt"></i>
                        4대보험
                    </button>
                </div>

                <!-- Employee Management Tab -->
                <div class="salary-tab-content active" id="employeesTab">
                    <div class="employee-actions">
                        <button class="btn btn-primary" onclick="showAddEmployeeForm()" title="직원 추가">
                            <i class="fas fa-plus"></i>
                            직원 추가
                        </button>
                        <div class="employee-search">
                            <input type="text" id="employeeSearch" placeholder="직원 검색..." class="form-control">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    
                    <div class="employees-list" id="employeesList">
                        <!-- 직원 목록이 동적으로 생성됩니다 -->
                    </div>
                    
                    <!-- Add Employee Form -->
                    <div class="add-employee-form add-employee-form-hidden" id="addEmployeeForm">
                        <h4>새 직원 등록</h4>
                        <form id="employeeForm" onsubmit="saveEmployee(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="empName">이름 *</label>
                                    <input type="text" id="empName" required class="form-control" placeholder="직원 이름 입력">
                                </div>
                                <div class="form-group">
                                    <label for="empId">사번</label>
                                    <input type="text" id="empId" class="form-control" placeholder="자동생성">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="empPosition">직급</label>
                                    <select id="empPosition" class="form-control" title="직원 직급 선택">
                                        <option value="사원">사원</option>
                                        <option value="주임">주임</option>
                                        <option value="대리">대리</option>
                                        <option value="과장">과장</option>
                                        <option value="차장">차장</option>
                                        <option value="부장">부장</option>
                                        <option value="정비사">정비사</option>
                                        <option value="정비보조">정비보조</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="empDepartment">부서</label>
                                    <select id="empDepartment" class="form-control" title="직원 부서 선택">
                                        <option value="정비">정비</option>
                                        <option value="관리">관리</option>
                                        <option value="영업">영업</option>
                                        <option value="기타">기타</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="empJoinDate">입사일</label>
                                    <input type="date" id="empJoinDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="empPhone">연락처</label>
                                    <input type="tel" id="empPhone" required class="form-control" placeholder="연락처 입력">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="empBaseSalary">기본급 (원)</label>
                                    <input type="number" id="empBaseSalary" required class="form-control" placeholder="기본급 입력">
                                </div>
                                <div class="form-group">
                                    <label for="empStatus">상태</label>
                                    <select id="empStatus" class="form-control" title="직원 상태 선택">
                                        <option value="재직">재직</option>
                                        <option value="휴직">휴직</option>
                                        <option value="퇴직">퇴직</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="cancelAddEmployee()">
                                    <i class="fas fa-times"></i>
                                    취소
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i>
                                    저장
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Salary Calculation Tab -->
                <div class="salary-tab-content" id="calculationTab">
                    <div class="salary-calc-header">
                        <div class="calc-period">
                            <label>급여 기간</label>
                            <select id="salaryYear" class="form-control" title="급여 연도 선택">
                                <option value="2024">2024년</option>
                                <option value="2023">2023년</option>
                            </select>
                            <select id="salaryMonth" class="form-control" title="급여 월 선택">
                                <option value="1">1월</option>
                                <option value="2">2월</option>
                                <option value="3">3월</option>
                                <option value="4">4월</option>
                                <option value="5">5월</option>
                                <option value="6">6월</option>
                                <option value="7">7월</option>
                                <option value="8">8월</option>
                                <option value="9">9월</option>
                                <option value="10">10월</option>
                                <option value="11">11월</option>
                                <option value="12">12월</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="loadSalaryCalculation()">
                            <i class="fas fa-calculator"></i>
                            급여 계산
                        </button>
                    </div>
                    
                    <div class="salary-calculation-list" id="salaryCalculationList">
                        <!-- 급여 계산 목록이 동적으로 생성됩니다 -->
                    </div>
                </div>

                <!-- Salary History Tab -->
                <div class="salary-tab-content" id="historyTab">
                    <div class="salary-history-header">
                        <div class="history-filters">
                            <input type="month" id="historyMonth" class="form-control">
                            <select id="historyEmployee" class="form-control" title="급여 내역 직원 선택">
                                <option value="">전체 직원</option>
                                <!-- 직원 목록이 동적으로 생성됩니다 -->
                            </select>
                        </div>
                        <button class="btn btn-secondary" onclick="loadSalaryHistory()">
                            <i class="fas fa-search"></i>
                            조회
                        </button>
                    </div>
                    
                    <div class="salary-history-list" id="salaryHistoryList">
                        <!-- 급여 지급 이력이 동적으로 생성됩니다 -->
                    </div>
                </div>

                <!-- Insurance Settings Tab -->
                <div class="salary-tab-content" id="insuranceTab">
                    <div class="insurance-settings">
                        <h4>4대보험 요율 설정</h4>
                        <div class="insurance-rates">
                            <div class="rate-item">
                                <label>국민연금 (4.5%)</label>
                                <input type="number" id="pensionRate" value="4.5" step="0.1" class="form-control">
                                <span>%</span>
                            </div>
                            <div class="rate-item">
                                <label>건강보험 (3.545%)</label>
                                <input type="number" id="healthRate" value="3.545" step="0.001" class="form-control">
                                <span>%</span>
                            </div>
                            <div class="rate-item">
                                <label>고용보험 (0.9%)</label>
                                <input type="number" id="employmentRate" value="0.9" step="0.1" class="form-control">
                                <span>%</span>
                            </div>
                            <div class="rate-item">
                                <label>산재보험 (0.7%)</label>
                                <input type="number" id="accidentRate" value="0.7" step="0.1" class="form-control">
                                <span>%</span>
                            </div>
                        </div>
                        
                        <div class="insurance-limits">
                            <h5>보험료 상한선</h5>
                            <div class="limit-item">
                                <label>국민연금 상한</label>
                                <input type="number" id="pensionLimit" value="5530000" class="form-control">
                                <span>원</span>
                            </div>
                            <div class="limit-item">
                                <label>건강보험 상한</label>
                                <input type="number" id="healthLimit" value="8730000" class="form-control">
                                <span>원</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="saveInsuranceSettings()">
                            <i class="fas fa-save"></i>
                            설정 저장
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeSalaryModal()">
                    <i class="fas fa-times"></i>
                    닫기
                </button>
            </div>
        </div>
    </div>

    <!-- VAT Report Modal -->
    <div id="vatReportModal" class="modal-overlay">
        <div class="modal-container large-modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-percentage"></i>
                    부가세 신고 준비
                </h2>
                <button class="modal-close" onclick="closeVatReportModal()" title="부가세 신고 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- VAT Report Tabs -->
                <div class="vat-tabs">
                    <button class="vat-tab active" data-tab="report" onclick="showVatTab('report')">
                        <i class="fas fa-file-alt"></i>
                        신고서 작성
                    </button>
                    <button class="vat-tab" data-tab="simulation" onclick="showVatTab('simulation')">
                        <i class="fas fa-calculator"></i>
                        납부액 시뮬레이션
                    </button>
                    <button class="vat-tab" data-tab="schedule" onclick="showVatTab('schedule')">
                        <i class="fas fa-calendar-check"></i>
                        신고 일정
                    </button>
                    <button class="vat-tab" data-tab="analysis" onclick="showVatTab('analysis')">
                        <i class="fas fa-chart-line"></i>
                        분석 리포트
                    </button>
                </div>

                <!-- VAT Report Tab -->
                <div class="vat-tab-content active" id="reportTab">
                    <div class="vat-report-header">
                        <div class="report-period-selector">
                            <label>신고 기간</label>
                            <select id="vatReportYear" class="form-control" title="부가세 연도 선택">
                                <option value="2024">2024년</option>
                                <option value="2023">2023년</option>
                            </select>
                            <select id="vatReportQuarter" class="form-control" title="부가세 분기 선택">
                                <option value="1">1분기 (1-3월)</option>
                                <option value="2">2분기 (4-6월)</option>
                                <option value="3">3분기 (7-9월)</option>
                                <option value="4">4분기 (10-12월)</option>
                            </select>
                            <button class="btn btn-primary" onclick="generateVatReport()">
                                <i class="fas fa-file-pdf"></i>
                                신고서 생성
                            </button>
                        </div>
                    </div>
                    
                    <!-- VAT Report Summary -->
                    <div class="vat-report-summary" id="vatReportSummary">
                        <!-- 동적으로 생성될 부가세 신고서 요약 -->
                    </div>
                    
                    <!-- VAT Report Details -->
                    <div class="vat-report-details" id="vatReportDetails">
                        <!-- 동적으로 생성될 부가세 신고서 상세 내역 -->
                    </div>
                    
                    <!-- VAT Report Actions -->
                    <div class="vat-report-actions">
                        <button class="btn btn-secondary" onclick="exportVatData('excel')">
                            <i class="fas fa-file-excel"></i>
                            엑셀로 내보내기
                        </button>
                        <button class="btn btn-secondary" onclick="exportVatData('csv')">
                            <i class="fas fa-file-csv"></i>
                            CSV로 내보내기
                        </button>
                        <button class="btn btn-success" onclick="generateVatPDF()">
                            <i class="fas fa-file-pdf"></i>
                            PDF 신고서 생성
                        </button>
                    </div>
                </div>

                <!-- VAT Simulation Tab -->
                <div class="vat-tab-content" id="simulationTab">
                    <div class="vat-simulation">
                        <h4>부가세 납부액 시뮬레이션</h4>
                        
                        <div class="simulation-inputs">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="simIncomeAmount">예상 매출 (공급가액)</label>
                                    <input type="number" id="simIncomeAmount" class="form-control" placeholder="10000000">
                                </div>
                                <div class="form-group">
                                    <label for="simExpenseAmount">예상 매입 (공급가액)</label>
                                    <input type="number" id="simExpenseAmount" class="form-control" placeholder="5000000">
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" onclick="runVatSimulation()">
                                <i class="fas fa-calculator"></i>
                                시뮬레이션 실행
                            </button>
                        </div>
                        
                        <div class="simulation-result" id="simulationResult">
                            <!-- 시뮬레이션 결과가 표시될 영역 -->
                        </div>
                    </div>
                </div>

                <!-- VAT Schedule Tab -->
                <div class="vat-tab-content" id="scheduleTab">
                    <div class="vat-schedule">
                        <h4>부가세 신고 일정</h4>
                        
                        <div class="schedule-timeline" id="scheduleTimeline">
                            <!-- 신고 일정이 표시될 영역 -->
                        </div>
                        
                        <div class="checklist-section">
                            <h5>신고 준비 체크리스트</h5>
                            <div class="vat-checklist" id="vatChecklist">
                                <!-- 체크리스트가 표시될 영역 -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VAT Analysis Tab -->
                <div class="vat-tab-content" id="analysisTab">
                    <div class="vat-analysis">
                        <h4>부가세 분석 리포트</h4>
                        
                        <div class="analysis-charts">
                            <div class="chart-container">
                                <canvas id="vatTrendChart" width="400" height="200"></canvas>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="vatBreakdownChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                        
                        <div class="analysis-summary" id="analysisSummary">
                            <!-- 분석 요약이 표시될 영역 -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeVatReportModal()">
                    <i class="fas fa-times"></i>
                    닫기
                </button>
            </div>
        </div>
    </div>

    <!-- Tax Help Center Modal -->
    <div id="taxHelpModal" class="modal-overlay">
        <div class="modal-container large-modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-graduation-cap"></i>
                    세무 도움말 센터
                </h2>
                <button class="modal-close" onclick="closeTaxHelpModal()" title="세무 도움말 닫기">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- Help Center Tabs -->
                <div class="help-tabs">
                    <button class="help-tab active" data-tab="guide" onclick="showHelpTab('guide')">
                        <i class="fas fa-route"></i>
                        시작 가이드
                    </button>
                    <button class="help-tab" data-tab="terms" onclick="showHelpTab('terms')">
                        <i class="fas fa-book"></i>
                        세무 용어
                    </button>
                    <button class="help-tab" data-tab="process" onclick="showHelpTab('process')">
                        <i class="fas fa-tasks"></i>
                        업무 프로세스
                    </button>
                    <button class="help-tab" data-tab="faq" onclick="showHelpTab('faq')">
                        <i class="fas fa-question"></i>
                        자주 묻는 질문
                    </button>
                </div>

                <!-- Guide Tab -->
                <div class="help-tab-content active" id="guideTab">
                    <div class="help-guide">
                        <h3>🚀 세무 관리 시작하기</h3>
                        <div class="guide-steps">
                            <div class="guide-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>매출 등록하기</h4>
                                    <p>고객에게 서비스를 제공하고 받은 수입을 기록합니다.</p>
                                    <ul>
                                        <li><strong>매출일자:</strong> 실제 서비스를 제공한 날짜</li>
                                        <li><strong>거래처:</strong> 고객 이름 또는 회사명</li>
                                        <li><strong>공급가액:</strong> 부가세를 제외한 순수 서비스 금액</li>
                                        <li><strong>부가세:</strong> 공급가액의 10% (자동 계산됨)</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="guide-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>경비 등록하기</h4>
                                    <p>사업을 위해 지출한 비용을 기록합니다.</p>
                                    <ul>
                                        <li><strong>매입일자:</strong> 실제 구매하거나 지불한 날짜</li>
                                        <li><strong>거래처:</strong> 구매한 상점이나 회사명</li>
                                        <li><strong>세금계산서:</strong> 일반/간이/없음으로 구분</li>
                                        <li><strong>매입세액공제:</strong> 부가세 환급받을 수 있는 금액</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="guide-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>부가세 신고하기</h4>
                                    <p>분기별로 매출세액과 매입세액을 정산합니다.</p>
                                    <ul>
                                        <li><strong>신고 기간:</strong> 1분기(1-3월), 2분기(4-6월), 3분기(7-9월), 4분기(10-12월)</li>
                                        <li><strong>신고 마감일:</strong> 각 분기 말월 25일</li>
                                        <li><strong>납부세액:</strong> 매출세액 - 매입세액공제</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Terms Tab -->
                <div class="help-tab-content" id="termsTab">
                    <div class="tax-terms">
                        <h3>📚 세무 용어 사전</h3>
                        <div class="terms-grid">
                            <div class="term-card">
                                <h4>공급가액 💰</h4>
                                <p><strong>의미:</strong> 부가세를 제외한 순수한 재화나 서비스의 가격</p>
                                <p><strong>예시:</strong> 정비비 100,000원 + 부가세 10,000원 = 총 110,000원일 때, 공급가액은 100,000원</p>
                                <p><strong>주의:</strong> 영수증에는 총액이 적혀있어도 공급가액을 따로 계산해야 함</p>
                            </div>
                            
                            <div class="term-card">
                                <h4>부가가치세 (VAT) 📊</h4>
                                <p><strong>의미:</strong> 재화나 서비스 거래 시 부과되는 세금 (10%)</p>
                                <p><strong>계산:</strong> 공급가액 × 10%</p>
                                <p><strong>종류:</strong> 매출세액(받은 부가세), 매입세액(낸 부가세)</p>
                            </div>
                            
                            <div class="term-card">
                                <h4>매입세액공제 ↩️</h4>
                                <p><strong>의미:</strong> 사업용 구매 시 낸 부가세를 돌려받는 것</p>
                                <p><strong>조건:</strong> 세금계산서나 신용카드 영수증 필요</p>
                                <p><strong>예시:</strong> 부품 구매 시 낸 부가세 5,000원을 환급받음</p>
                            </div>
                            
                            <div class="term-card">
                                <h4>세금계산서 📋</h4>
                                <p><strong>의미:</strong> 부가세 거래를 증명하는 공식 서류</p>
                                <p><strong>종류:</strong></p>
                                <ul>
                                    <li><strong>일반:</strong> 매입세액공제 100% 가능</li>
                                    <li><strong>간이:</strong> 매입세액공제 제한적</li>
                                    <li><strong>없음:</strong> 현금영수증, 신용카드 영수증</li>
                                </ul>
                            </div>
                            
                            <div class="term-card">
                                <h4>분기별 신고 📅</h4>
                                <p><strong>의미:</strong> 3개월마다 부가세를 정산하여 신고</p>
                                <p><strong>신고 기간:</strong></p>
                                <ul>
                                    <li>1분기: 1월~3월 (4월 25일까지)</li>
                                    <li>2분기: 4월~6월 (7월 25일까지)</li>
                                    <li>3분기: 7월~9월 (10월 25일까지)</li>
                                    <li>4분기: 10월~12월 (1월 25일까지)</li>
                                </ul>
                            </div>
                            
                            <div class="term-card">
                                <h4>카테고리 분류 🏷️</h4>
                                <p><strong>매출 카테고리:</strong></p>
                                <ul>
                                    <li>정비서비스, 부품판매, 점검서비스 등</li>
                                </ul>
                                <p><strong>매입 카테고리:</strong></p>
                                <ul>
                                    <li>부품구매, 공구구매, 임대료, 전기료 등</li>
                                </ul>
                                <p><strong>tip:</strong> 정확한 분류로 세무 관리가 쉬워집니다</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Process Tab -->
                <div class="help-tab-content" id="processTab">
                    <div class="process-guide">
                        <h3>⚙️ 업무 프로세스 가이드</h3>
                        
                        <div class="process-section">
                            <h4>🔄 일반적인 업무 흐름</h4>
                            <div class="process-flow">
                                <div class="process-item">
                                    <i class="fas fa-wrench"></i>
                                    <span>정비 서비스 제공</span>
                                </div>
                                <div class="process-arrow">→</div>
                                <div class="process-item">
                                    <i class="fas fa-plus"></i>
                                    <span>매출 등록</span>
                                </div>
                                <div class="process-arrow">→</div>
                                <div class="process-item">
                                    <i class="fas fa-shopping-cart"></i>
                                    <span>부품/재료 구매</span>
                                </div>
                                <div class="process-arrow">→</div>
                                <div class="process-item">
                                    <i class="fas fa-minus"></i>
                                    <span>경비 등록</span>
                                </div>
                                <div class="process-arrow">→</div>
                                <div class="process-item">
                                    <i class="fas fa-file-alt"></i>
                                    <span>분기별 신고</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="process-section">
                            <h4>📝 매출 등록 상세 프로세스</h4>
                            <div class="process-checklist">
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>정비 완료 후 고객에게 청구서 발행</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>견적서 시스템에서 자동으로 매출 데이터 생성</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>추가 매출이 있는 경우 "매출 등록" 버튼으로 직접 입력</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>카테고리를 정확히 선택 (정비서비스/부품판매/점검서비스/기타)</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>공급가액 입력 시 부가세는 자동으로 계산됨</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="process-section">
                            <h4>💳 경비 등록 상세 프로세스</h4>
                            <div class="process-checklist">
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>부품이나 재료 구매 후 영수증 보관</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>"경비 등록" 버튼으로 지출 내역 입력</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>세금계산서 종류 선택 (일반/간이/없음)</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>카테고리 정확히 분류 (부품구매/공구구매/임대료 등)</span>
                                </div>
                                <div class="checklist-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>증빙서류 종류 선택 및 보관</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ Tab -->
                <div class="help-tab-content" id="faqTab">
                    <div class="faq-section">
                        <h3>❓ 자주 묻는 질문</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>부가세는 언제 내야 하나요?</span>
                            </div>
                            <div class="faq-answer">
                                <p>부가세는 <strong>분기별로 신고</strong>합니다:</p>
                                <ul>
                                    <li>1분기 (1-3월): 4월 25일까지</li>
                                    <li>2분기 (4-6월): 7월 25일까지</li>
                                    <li>3분기 (7-9월): 10월 25일까지</li>
                                    <li>4분기 (10-12월): 다음 해 1월 25일까지</li>
                                </ul>
                                <p>납부할 세액이 있으면 신고와 동시에 납부해야 합니다.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>공급가액과 총액의 차이가 뭔가요?</span>
                            </div>
                            <div class="faq-answer">
                                <p><strong>공급가액</strong>은 부가세를 제외한 순수한 재화나 서비스의 가격입니다.</p>
                                <p><strong>총액</strong>은 공급가액 + 부가세(10%)입니다.</p>
                                <p><strong>예시:</strong></p>
                                <ul>
                                    <li>정비비 공급가액: 100,000원</li>
                                    <li>부가세: 10,000원 (100,000원 × 10%)</li>
                                    <li>총액: 110,000원</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>매입세액공제는 어떻게 받나요?</span>
                            </div>
                            <div class="faq-answer">
                                <p>사업을 위해 구매한 물품의 부가세를 환급받는 제도입니다:</p>
                                <ul>
                                    <li><strong>조건:</strong> 세금계산서, 신용카드 영수증, 현금영수증 보유</li>
                                    <li><strong>공제율:</strong> 일반 세금계산서 100%, 간이 세금계산서 제한적</li>
                                    <li><strong>신고:</strong> 분기별 부가세 신고 시 자동으로 차감</li>
                                </ul>
                                <p><strong>주의:</strong> 개인용 구매는 공제받을 수 없습니다.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>영수증을 잃어버렸어도 경비 처리할 수 있나요?</span>
                            </div>
                            <div class="faq-answer">
                                <p>영수증이 없으면 매입세액공제를 받을 수 없지만, 경비 자체는 처리 가능합니다:</p>
                                <ul>
                                    <li><strong>매입세액공제:</strong> 불가능</li>
                                    <li><strong>비용 처리:</strong> 가능 (소득세 계산 시 비용으로 인정)</li>
                                    <li><strong>대안:</strong> 신용카드 내역서, 계좌이체 내역 등으로 증빙</li>
                                </ul>
                                <p><strong>권장:</strong> 가능한 모든 영수증을 보관하세요.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>카테고리 분류를 잘못했어도 문제없나요?</span>
                            </div>
                            <div class="faq-answer">
                                <p>카테고리 분류는 <strong>세무 관리와 분석</strong>을 위한 것으로:</p>
                                <ul>
                                    <li><strong>세금 계산:</strong> 영향 없음 (총액만 중요)</li>
                                    <li><strong>관리 효율:</strong> 정확한 분류로 비용 분석 가능</li>
                                    <li><strong>수정:</strong> 언제든 수정 가능</li>
                                </ul>
                                <p><strong>팁:</strong> 처음에는 대략적으로 분류하고, 나중에 정리해도 됩니다.</p>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <i class="fas fa-chevron-right"></i>
                                <span>이 프로그램만으로 세무신고가 완료되나요?</span>
                            </div>
                            <div class="faq-answer">
                                <p>이 프로그램은 <strong>세무 데이터 관리</strong>를 도와주는 도구입니다:</p>
                                <ul>
                                    <li><strong>제공 기능:</strong> 매출/매입 관리, 부가세 계산, 리포트 생성</li>
                                    <li><strong>실제 신고:</strong> 국세청 홈택스에서 직접 신고 필요</li>
                                    <li><strong>세무사:</strong> 복잡한 경우 전문가 상담 권장</li>
                                </ul>
                                <p><strong>활용법:</strong> 이 프로그램으로 데이터를 정리한 후, 홈택스나 세무사에게 제공</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTaxHelpModal()">
                    <i class="fas fa-times"></i>
                    닫기
                </button>
                <button class="btn btn-primary" onclick="enableBeginnerMode()">
                    <i class="fas fa-graduation-cap"></i>
                    초보자 모드 켜기
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Bootstrap JS (Optimized) -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- JSZip for ZIP file generation (Lazy Load) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script defer src="app.js"></script>
</body>
</html> 